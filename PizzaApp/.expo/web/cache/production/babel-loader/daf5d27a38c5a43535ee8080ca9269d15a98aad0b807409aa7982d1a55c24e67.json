{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable;})),t.push.apply(t,o);}return t;}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach(function(r){_defineProperty(e,r,t[r]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r));});}return e;}import{create}from\"apisauce\";import Config from\"../../config\";import{getGeneralApiProblem}from\"./apiProblem\";export var DEFAULT_API_CONFIG={url:Config.API_URL,timeout:10000};export var Api=function(){function Api(){var config=arguments.length>0&&arguments[0]!==undefined?arguments[0]:DEFAULT_API_CONFIG;_classCallCheck(this,Api);this.config=config;this.apisauce=create({baseURL:this.config.url,timeout:this.config.timeout,headers:{Accept:\"application/json\"}});}_createClass(Api,[{key:\"getEpisodes\",value:function(){var _getEpisodes=_asyncToGenerator(function*(){var response=yield this.apisauce.get(\"api.json?rss_url=https%3A%2F%2Ffeeds.simplecast.com%2FhEI_f9Dx\");if(!response.ok){var problem=getGeneralApiProblem(response);if(problem)return problem;}try{var rawData=response.data;var episodes=rawData.items.map(function(raw){return _objectSpread({},raw);});return{kind:\"ok\",episodes:episodes};}catch(e){if(__DEV__){console.tron.error(\"Bad data: \"+e.message+\"\\n\"+response.data,e.stack);}return{kind:\"bad-data\"};}});function getEpisodes(){return _getEpisodes.apply(this,arguments);}return getEpisodes;}()}]);return Api;}();export var api=new Api();","map":{"version":3,"names":["create","Config","getGeneralApiProblem","DEFAULT_API_CONFIG","url","API_URL","timeout","Api","config","arguments","length","undefined","_classCallCheck","apisauce","baseURL","headers","Accept","_createClass","key","value","_getEpisodes","_asyncToGenerator","response","get","ok","problem","rawData","data","episodes","items","map","raw","_objectSpread","kind","e","__DEV__","console","tron","error","message","stack","getEpisodes","apply","api"],"sources":["/home/ehsan/dockerize-expo-rn-web-app/PizzaApp/app/services/api/api.ts"],"sourcesContent":["/**\n * This Api class lets you define an API endpoint and methods to request\n * data and process it.\n *\n * See the [Backend API Integration](https://github.com/infinitered/ignite/blob/master/docs/Backend-API-Integration.md)\n * documentation for more details.\n */\nimport {\n  ApiResponse, // @demo remove-current-line\n  ApisauceInstance,\n  create,\n} from \"apisauce\"\nimport Config from \"../../config\"\nimport { GeneralApiProblem, getGeneralApiProblem } from \"./apiProblem\" // @demo remove-current-line\nimport type {\n  ApiConfig,\n  ApiFeedResponse, // @demo remove-current-line\n} from \"./api.types\"\nimport type { EpisodeSnapshotIn } from \"../../models/Episode\" // @demo remove-current-line\n\n/**\n * Configuring the apisauce instance.\n */\nexport const DEFAULT_API_CONFIG: ApiConfig = {\n  url: Config.API_URL,\n  timeout: 10000,\n}\n\n/**\n * Manages all requests to the API. You can use this class to build out\n * various requests that you need to call from your backend API.\n */\nexport class Api {\n  apisauce: ApisauceInstance\n  config: ApiConfig\n\n  /**\n   * Set up our API instance. Keep this lightweight!\n   */\n  constructor(config: ApiConfig = DEFAULT_API_CONFIG) {\n    this.config = config\n    this.apisauce = create({\n      baseURL: this.config.url,\n      timeout: this.config.timeout,\n      headers: {\n        Accept: \"application/json\",\n      },\n    })\n  }\n\n  // @demo remove-block-start\n  /**\n   * Gets a list of recent React Native Radio episodes.\n   */\n  async getEpisodes(): Promise<{ kind: \"ok\"; episodes: EpisodeSnapshotIn[] } | GeneralApiProblem> {\n    // make the api call\n    const response: ApiResponse<ApiFeedResponse> = await this.apisauce.get(\n      `api.json?rss_url=https%3A%2F%2Ffeeds.simplecast.com%2FhEI_f9Dx`,\n    )\n\n    // the typical ways to die when calling an api\n    if (!response.ok) {\n      const problem = getGeneralApiProblem(response)\n      if (problem) return problem\n    }\n\n    // transform the data into the format we are expecting\n    try {\n      const rawData = response.data\n\n      // This is where we transform the data into the shape we expect for our MST model.\n      const episodes: EpisodeSnapshotIn[] = rawData.items.map((raw) => ({\n        ...raw,\n      }))\n\n      return { kind: \"ok\", episodes }\n    } catch (e) {\n      if (__DEV__) {\n        console.tron.error(`Bad data: ${e.message}\\n${response.data}`, e.stack)\n      }\n      return { kind: \"bad-data\" }\n    }\n  }\n  // @demo remove-block-end\n}\n\n// Singleton instance of the API for convenience\nexport const api = new Api()\n"],"mappings":"s3BAOA,OAGEA,MAAM,KACD,UAAU,CACjB,MAAO,CAAAC,MAAM,oBACb,OAA4BC,oBAAoB,oBAUhD,MAAO,IAAM,CAAAC,kBAA6B,CAAG,CAC3CC,GAAG,CAAEH,MAAM,CAACI,OAAO,CACnBC,OAAO,CAAE,KACX,CAAC,CAMD,UAAa,CAAAC,GAAG,YAOd,SAAAA,IAAA,CAAoD,IAAxC,CAAAC,MAAiB,CAAAC,SAAA,CAAAC,MAAA,IAAAD,SAAA,MAAAE,SAAA,CAAAF,SAAA,IAAGN,kBAAkB,CAAAS,eAAA,MAAAL,GAAA,EAChD,IAAI,CAACC,MAAM,CAAGA,MAAM,CACpB,IAAI,CAACK,QAAQ,CAAGb,MAAM,CAAC,CACrBc,OAAO,CAAE,IAAI,CAACN,MAAM,CAACJ,GAAG,CACxBE,OAAO,CAAE,IAAI,CAACE,MAAM,CAACF,OAAO,CAC5BS,OAAO,CAAE,CACPC,MAAM,CAAE,kBACV,CACF,CAAC,CAAC,CACJ,CAACC,YAAA,CAAAV,GAAA,GAAAW,GAAA,eAAAC,KAAA,gBAAAC,YAAA,CAAAC,iBAAA,CAMD,WAAgG,CAE9F,GAAM,CAAAC,QAAsC,MAAS,KAAI,CAACT,QAAQ,CAACU,GAAG,iEAEtE,CAAC,CAGD,GAAI,CAACD,QAAQ,CAACE,EAAE,CAAE,CAChB,GAAM,CAAAC,OAAO,CAAGvB,oBAAoB,CAACoB,QAAQ,CAAC,CAC9C,GAAIG,OAAO,CAAE,MAAO,CAAAA,OAAO,CAC7B,CAGA,GAAI,CACF,GAAM,CAAAC,OAAO,CAAGJ,QAAQ,CAACK,IAAI,CAG7B,GAAM,CAAAC,QAA6B,CAAGF,OAAO,CAACG,KAAK,CAACC,GAAG,CAAC,SAACC,GAAG,SAAAC,aAAA,IACvDD,GAAG,GACN,CAAC,CAEH,MAAO,CAAEE,IAAI,CAAE,IAAI,CAAEL,QAAQ,CAARA,QAAS,CAAC,CACjC,CAAE,MAAOM,CAAC,CAAE,CACV,GAAIC,OAAO,CAAE,CACXC,OAAO,CAACC,IAAI,CAACC,KAAK,cAAcJ,CAAC,CAACK,OAAO,MAAKjB,QAAQ,CAACK,IAAI,CAAIO,CAAC,CAACM,KAAK,CAAC,CACzE,CACA,MAAO,CAAEP,IAAI,CAAE,UAAW,CAAC,CAC7B,CACF,CAAC,WAAAQ,YAAA,SAAArB,YAAA,CAAAsB,KAAA,MAAAjC,SAAA,UAAAgC,WAAA,eAAAlC,GAAA,KAKH,MAAO,IAAM,CAAAoC,GAAG,CAAG,GAAI,CAAApC,GAAG,CAAC,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}